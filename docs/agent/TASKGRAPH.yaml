version: 1
project_id: diff-epi-inference-handbook

defaults:
  acceptance:
    - uv run pytest -q
    - quarto render book --to html

tasks:
  # M3 — Likelihood-free baselines closure
  - id: M3.1
    title: "M3 DoD: verify likelihood-free baselines chapter executes in CI (ABC/SMC-ABC/synthetic likelihood)"
    depends_on: []
  - id: M3.2
    title: "M3: add one minimal diagnostic per method (ABC/SMC-ABC/synth-lik) + tiny helper functions"
    depends_on: [M3.1]
  - id: M3.3
    title: "Chore: update status/docs to mark M3 complete and set milestone to M4"
    depends_on: [M3.2]
  - id: M3.END
    title: "Milestone end: M3 complete (gate on CI)"
    depends_on: [M3.3]
  - id: CI.FIX.M3
    title: "CI fix: make GitHub Actions green for M3 boundary"
    depends_on: [M3.END]

  # M4 — Modern SBI (flows + NPE/NLE/NRE)
  - id: M4.0
    title: Make modern-sbi deps reproducible and run JAX cells in CI HTML build
    depends_on: [M3.END]
  - id: M4.1
    title: Add minimal conditional affine flow helper + tests
    depends_on: [M4.0]
  - id: M4.2
    title: Add tiny JAX-based training loop example (modern-sbi extra)
    depends_on: [M4.1]
  - id: M4.3
    title: Use ConditionalAffineDiagNormal helper in Modern SBI demo
    depends_on: [M4.2]
  - id: M4.4
    title: Add amortised vs local training comparison
    depends_on: [M4.3]
  - id: M4.5
    title: Add brief NLE and NRE sections
    depends_on: [M4.4]
  - id: M4.END
    title: "Milestone end: M4 complete (gate on CI)"
    depends_on: [M4.5]
  - id: CI.FIX.M4
    title: "CI fix: make GitHub Actions green for M4 boundary"
    depends_on: [M4.END]

  # M5 — Runnable modern-sbi example + reproducibility tightening
  - id: M5.0
    title: "Modern SBI: add runnable end-to-end example notebook/section (offline, deterministic)"
    depends_on: [M4.END]
  - id: M5.1
    title: "Modern SBI: add acceptance tests for example outputs (golden checks)"
    depends_on: [M5.0]
  - id: M5.2
    title: "Docs: tighten installation/reproducibility (extras matrix + CPU/GPU notes)"
    depends_on: [M5.1]
  - id: M5.3
    title: "CI: add optional job for modern-sbi example section (best-effort)"
    depends_on: [M5.2]
  - id: M5.4
    title: "Chore: mark M5 complete and select next milestone"
    depends_on: [M5.3]
  - id: M5.END
    title: "Milestone end: M5 complete (gate on CI)"
    depends_on: [M5.4]
  - id: CI.FIX.M5
    title: "CI fix: make GitHub Actions green for M5 boundary"
    depends_on: [M5.END]

  # M6 — Autodiff + differentiability axis
  - id: M6.0
    title: "Book: add autodiff basics + differentiability axis chapters (skeleton + wiring)"
    depends_on: [M5.END]
  - id: M6.1
    title: "Book/code: add runnable autodiff demos (JVP/VJP intuition) + helper module + tests"
    depends_on: [M6.0]
  - id: M6.2
    title: "Book: differentiable vs non-differentiable simulators chapter with decision checklist + demos"
    depends_on: [M6.1]
  - id: M6.3
    title: "Book/code: gradient estimators & relaxations (REINFORCE, reparam, straight-through, Gumbel-Softmax)"
    depends_on: [M6.2]
  - id: M6.4
    title: "Case study: toy differentiable epidemiology example (relaxation + gradient fit) + smoke tests"
    depends_on: [M6.3]
  - id: M6.END
    title: "Milestone end: M6 complete (gate on CI)"
    depends_on: [M6.4]
  - id: CI.FIX.M6
    title: "CI fix: make GitHub Actions green for M6 boundary"
    depends_on: [M6.END]

  # M7 — Validation + robustness + cookbook
  - id: M7.0
    title: "Book: add validation/robustness chapter (PPC, SBC, sensitivity)"
    depends_on: [M6.END]
  - id: M7.1
    title: "Code: implement reusable diagnostics helpers (ppc/coverage/sbc) + tests"
    depends_on: [M7.0]
  - id: M7.2
    title: "Book: add failure modes section with one intentionally broken example"
    depends_on: [M7.1]
  - id: M7.3
    title: "Book: method-selection guide flowchart + checklist (cookbook page)"
    depends_on: [M7.2]
  - id: M7.END
    title: "Milestone end: M7 complete (gate on CI)"
    depends_on: [M7.3]
  - id: CI.FIX.M7
    title: "CI fix: make GitHub Actions green for M7 boundary"
    depends_on: [M7.END]

  # M8 — Polish + publication automation
  - id: M8.0
    title: "Book: add glossary + notation index and link acronyms"
    depends_on: [M7.END]
  - id: M8.1
    title: "Book: add citations/bibliography system (references.bib) and replace informal mentions"
    depends_on: [M8.0]
  - id: M8.2
    title: "PDF quality pass: styling, code blocks, figures, numbering"
    depends_on: [M8.1]
  - id: M8.3
    title: "CI: release automation to upload PDF artefact on tags and tighten tag pipeline"
    depends_on: [M8.2]
  - id: M8.4
    title: "Chore: changelog + versioning notes"
    depends_on: [M8.3]
  - id: M8.END
    title: "Milestone end: M8 complete (gate on CI)"
    depends_on: [M8.4]
  - id: CI.FIX.M8
    title: "CI fix: make GitHub Actions green for M8 boundary"
    depends_on: [M8.END]
